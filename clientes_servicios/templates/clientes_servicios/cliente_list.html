<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Lista de Clientes</title>
</head>
<body>
    <h1>Lista de Clientes</h1>
    <a href="{% url 'cliente_create' %}">+ Registrar cliente</a>

    <!-- FORMULARIO DE BÚSQUEDA / FILTRO -->
    <form method="get" style="margin:12px 0;">
        <input type="text" name="q" placeholder="Buscar por nombre, apellido, NIT, teléfono o correo"
               value="{{ q }}">
        <select name="tipo">
            <option value="">Todos</option>
            {% for t in tipos %}
                <option value="{{ t }}" {% if tipo == t %}selected{% endif %}>{{ t }}</option>
            {% endfor %}
        </select>
        <button type="submit">Buscar / Filtrar</button>
        <a href="{% url 'cliente_list' %}">Limpiar</a>
    </form>

    <table border="1" cellpadding="5">
        <thead>
            <tr>
                <th>Nombre</th>
                <th>NIT</th>
                <th>Teléfono</th>
                <th>Correo</th>
                <th>Tipo</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for c in clientes %}
            <tr>
                <td><a href="{% url 'cliente_detail' c.pk %}">{{ c.nombre }} {{ c.apellido }}</a></td>
                <td>{{ c.nit }}</td>
                <td>{{ c.telefono }}</td>
                <td>{{ c.correo }}</td>
                <td>{{ c.tipo_cliente }}</td>
                <td>
                    <a href="{% url 'cliente_edit' c.pk %}">Editar</a>
                    <a href="{% url 'cliente_delete' c.pk %}">Eliminar</a>
                </td>
            </tr>
            {% empty %}
            <tr><td colspan="6">No hay clientes registrados</td></tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- PAGINACIÓN: conserva q y tipo en los enlaces -->
    <div class="pagination" style="margin-top:12px;">
      {% if clientes.has_previous %}
        <a href="?page={{ clientes.previous_page_number }}{% if q %}&q={{ q }}{% endif %}{% if tipo %}&tipo={{ tipo }}{% endif %}">Anterior</a>
      {% endif %}

      <span>Página {{ clientes.number }} de {{ clientes.paginator.num_pages }}</span>

      {% if clientes.has_next %}
        <a href="?page={{ clientes.next_page_number }}{% if q %}&q={{ q }}{% endif %}{% if tipo %}&tipo={{ tipo }}{% endif %}">Siguiente</a>
      {% endif %}
    </div>
</body>
</html>
